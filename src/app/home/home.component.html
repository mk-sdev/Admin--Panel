<div>
  <app-navbar></app-navbar>

  <div class="container">
    <div class="user-list">
      <h3 i18n>List of users</h3>
      <div
        *ngFor="let user of userItems; trackBy: trackByUserId"
        class="user-item"
        (click)="showUser(user._id)"
      >
        {{ user.email }}
      </div>
    </div>

    <div *ngIf="user" class="user">
      <div>
        <input
          type="text"
          [(ngModel)]="searchQuery"
          placeholder="Search by id or email"
          i18n-placeholder
        />
        <button i18n [disabled]="!searchQuery" (click)="findUser()">search</button>
      </div>
      <span *ngIf="error">{{ error }}</span>

      <div id="user-attributes">
        <button i18n (click)="editMode = !editMode">edit</button>
        <div>_id: {{ user._id }}</div>
        <div *ngIf="!editMode">Email: {{ user.email }}</div>
        <div *ngIf="editMode">
          <label>
            Email:
            <input
              type="email"
              [(ngModel)]="user.email"
              placeholder="Enter email"
          /></label>
        </div>
        <div *ngIf="!editMode">Roles: {{ user.roles }}</div>
        <div *ngIf="editMode">
          Roles:
          <label *ngFor="let role of rolesList">
            <input
              type="checkbox"
              [disabled]="role === 'USER'"
              [value]="role"
              (change)="onRoleChange($event)"
              [checked]="user.roles.includes(role)"
            />
            {{ role }}
          </label>
        </div>
        <div>Provider: {{ user.provider }}</div>
        <div>isVerified: {{ user.isVerified }}</div>
      </div>

      <button i18n *ngIf="editMode" (click)="saveUser()">Save</button>
      <button i18n (click)="logUserOut()">log out</button>
      <input i18n-placeholder type="text" [(ngModel)]="newPassword" placeholder="New Password" />
      <button i18n (click)="changePassword()">Confirm new password</button>
    </div>
  </div>
</div>
